<div class="div-pag">

<mat-card class="container-box-pg" >
  <h1 mat-dialog-title>
    {{  'Pagamentos' }}
  </h1>

  <mat-form-field appearance="fill"  >
    <mat-label>ID do Pagamento</mat-label>
    <input matInput [value]="pagamento.idPagamento" disabled>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Código de Origem</mat-label>
    <input matInput [(ngModel)]="pagamento.origemId" disabled>
  </mat-form-field>

  <mat-form-field appearance="fill" >
    <mat-label>Tipo Origem</mat-label>
    <input matInput [value]="pagamento.tipoOrigem" disabled>
  </mat-form-field>

 <!-- <mat-form-field appearance="fill" >
    <mat-label>Data</mat-label>
    <input matInput [matDatepicker]="picker" [(ngModel)]="pagamento.dtPagamento" >
    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker></mat-datepicker>
  </mat-form-field>-->

  <mat-form-field  appearance="fill">
    <mat-label>Data</mat-label>
    <input matInput [value]="pagamento.dtPagamento | dateLocalBR " disabled>
  </mat-form-field>

  <mat-form-field matColumnDef="valor">
    <mat-label> Valor </mat-label>
    <input matInput [value]="pagamento.valorPago | currencyBRL " >
  </mat-form-field>

  <mat-form-field appearance="fill"  >
    <mat-label>Formas de Pagamento</mat-label>
    <input type="text"
           placeholder="Formas de Pagamento"
           matInput
           [formControl]="formaPagamentoControl"
           [matAutocomplete]="autoformapg"/>
    <mat-error>Campo Obrigatório não preenchido.</mat-error>

    <mat-autocomplete #autoformapg="matAutocomplete" [displayWith]="displayFormasDePg">
      <mat-option *ngFor="let formasPg of formaDePgFiltrad | async" [value]="formasPg">
        {{formasPg}}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>

   <mat-form-field  appearance="fill">
    <mat-label>Status do Pagamento</mat-label>
    <input type="text"
           placeholder="Status de Pagamentos"
           matInput
           [formControl]="statusPgControl"
           [matAutocomplete]="autstatus"/>
    <mat-error>Campo Obrigatório não preenchido.</mat-error>

    <mat-autocomplete #autstatus="matAutocomplete" [displayWith]="displayStatus">
      <mat-option *ngFor="let statusPg of statusFiltradPg | async" [value]="statusPg">
        {{statusPg}}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>

  <div class="actions">
    <button mat-button (click)="onCancel()" >Cancelar</button>
  </div>

</mat-card>

  <mat-card class="container-tb-pag" >

  <table #tablePg mat-table class="table-pg " id="tablePagamento" [dataSource]="tbSourcePagamentos$"
         matSort (matSortChange)="onMatSortChange()" matSortDirection="asc"
         multiTemplateDataRows >

    <ng-container matColumnDef="origemId">
      <th mat-header-cell *matHeaderCellDef> Id da Origem</th>
      <td mat-cell *matCellDef="let element"> {{element.origemId}} </td>
    </ng-container>

    <ng-container matColumnDef="tipoOrigem">
      <th mat-header-cell *matHeaderCellDef> Tipo da Origem</th>
      <td mat-cell *matCellDef="let element"> {{element.tipoOrigem}} </td>
    </ng-container>

    <ng-container matColumnDef="valor">
      <th mat-header-cell *matHeaderCellDef> Valor </th>
      <td mat-cell *matCellDef="let element"> {{element.valorPago}} </td>
    </ng-container>

    <ng-container matColumnDef="formaPagamento">
      <th mat-header-cell *matHeaderCellDef> forma de Pagamento</th>
      <td mat-cell *matCellDef="let element"> {{element.formaPagamento}} </td>
    </ng-container>
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef> Status</th>
      <td mat-cell *matCellDef="let element"> {{element.status}} </td>
    </ng-container>

    <ng-container matColumnDef="opicoes">
      <th mat-header-cell *matHeaderCellDef> Opições</th>
      <td mat-cell *matCellDef="let element">
        <button mat-icon-button class="edit componet-gradient" (click)="editarElement(element)">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button class="delete componet-gradient" (click)="deleteElement(element.id_Pagamento)">
          <mat-icon>delete</mat-icon>
        </button>
        <button *ngIf="element.status === 1" class="btn btn-sm btn-outline-danger"
                (click)="estornar(element.idPagamento)">
          Estornar
        </button>
        <span [ngClass]="{'badge bg-success': element.status === 1, 'badge bg-danger': element.status === 2}">
              {{ getLabelStatus(element.status) }}
            </span>

      </td>

    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row  *matRowDef="let row; columns: displayedColumns; "  (click)="selectRow(row)"></tr>

    <tr class="mat-row" *matNoDataRow>
      <td class="mat-cell" colspan="3"></td>
    </tr>

  </table>
  <mat-paginator [length]="100"
                 [pageSize]="5"
                 [pageSizeOptions]="[5, 10, 25, 100]"
                 aria-label="Select page">
  </mat-paginator>


  </mat-card>

</div>

